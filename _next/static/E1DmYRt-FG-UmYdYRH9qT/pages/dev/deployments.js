(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"7ljp":function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return d}));var a=n("q1tI"),o=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=o.a.createContext({}),p=function(e){var t=o.a.useContext(c),n=t;return e&&(n="function"===typeof e?e(t):s(s({},t),e)),n},b=function(e){var t=p(e.components);return(o.a.createElement(c.Provider,{value:t},e.children))},u="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return(o.a.createElement(o.a.Fragment,{},t))}},m=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),b=p(n),u=a,m=b["".concat(i,".").concat(u)]||b[u]||h[u]||r;return n?o.a.createElement(m,s(s({ref:t},c),{},{components:n})):o.a.createElement(m,s({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"===typeof e||a){var r=n.length,i=new Array(r);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"===typeof e?e:a,i[1]=s;for(var c=2;c<r;c++)i[c]=n[c];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},Ff2n:function(e,t,n){"use strict";function a(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}n.d(t,"a",(function(){return a}))},Qetd:function(e,t,n){"use strict";var a=Object.assign.bind(Object);e.exports=a,e.exports.default=e.exports},dR22:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dev/deployments",function(){return n("yEvT")}])},wx14:function(e,t,n){"use strict";function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return a}))},yEvT:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var a=n("wx14"),o=n("Ff2n"),r=n("q1tI"),i=n.n(r),s=n("7ljp"),l=(i.a.createElement,{}),c="wrapper";function p(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(s.b)(c,Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(s.b)("h1",null,"Deployment"),Object(s.b)("p",null,"Deploys of the NPM and PyPI packages are handled automatically. CircleCI is configured to\nautomatically deploy packages from tagged commits that start with ",Object(s.b)("inlineCode",{parentName:"p"},"v"),". The packages will be built\nautomatically and pushed to the relevant package indexes."),Object(s.b)("h2",null,"Release Issues"),Object(s.b)("p",null,"That's not all that there is to making a release though. The tag needs made, the changelog updated,\nand other manual tasks need done. To ensure consistency we use release issues on GitHub to plan,\nassign, and execute on new releases. You can see examples of existing release issues\n",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/mozilla/nimbus-shared/issues?q=is%3Aissue+label%3Areleases+sort%3Acreated-desc"}),"here"),"."),Object(s.b)("p",null,"The last step in each release bug is to create a new issue based on the current ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/mozilla/nimbus-shared/issues/new?assignees=&labels=&template=release-checklist.md&title=Release+VERSION"}),"release\ntemplate"),". Any changes that need to be made to the deploy process should happen as pull requests\nthat update that template."),Object(s.b)("h2",null,"Credentials"),Object(s.b)("p",null,"The credentials that are used for deployments are linked to an account named\n",Object(s.b)("inlineCode",{parentName:"p"},"project-nimbus-publishing")," on both NPM and PyPI, and those accounts are tied to the email address\n",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"mailto:project-nimbus-publishing@mozilla.com."}),"project-nimbus-publishing@mozilla.com.")," Each of the PyPI and NPM accounts have an API key that is\ngiven to CircleCI for deployments."),Object(s.b)("p",null,"This email address is a private Google Group that several engineers from the Nimbus have access to.\nThe password to these accounts is not shared, and if someone who does not have the current password\nneeds to work with the accounts, they can use a password reset to gain access."),Object(s.b)("h3",null,"How to reset account passwords"),Object(s.b)("p",null,"In case you need to get or reset the password for one of the accounts, use these steps:"),Object(s.b)("ol",null,Object(s.b)("li",{parentName:"ol"},'Use the "reset password" option of the relevant site.'),Object(s.b)("li",{parentName:"ol"},"Reply to the mailing list thread to confirm that the password reset was legitimate, and to\nidentify who did it to the rest of the team."),Object(s.b)("li",{parentName:"ol"},"Change the password on the account. Do not share the new password with anyone."),Object(s.b)("li",{parentName:"ol"},"Optionally, store the new password as you would any other private password.")),Object(s.b)("h3",null,"How to reset tokens"),Object(s.b)("p",null,"In case the tokens used to authenticate to the account are lost or leaked, reset them using these\nsteps. Consider using Firefox Containers to seperate your normal login from the shared one (for\nconvenience)."),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("p",{parentName:"li"},"NPM"),Object(s.b)("ol",{parentName:"li"},Object(s.b)("li",{parentName:"ol"},"Log in to NPM as project-nimbus-publishing."),Object(s.b)("li",{parentName:"ol"},'Click on the avatar in the top right, and choose "Auth Tokens".'),Object(s.b)("li",{parentName:"ol"},"Delete the old token with the X on the right side."),Object(s.b)("li",{parentName:"ol"},"Create new token with rights to both read and publish."),Object(s.b)("li",{parentName:"ol"},"Immediately copy that token to CircleCI as ",Object(s.b)("inlineCode",{parentName:"li"},"NPM_TOKEN")," (see below)."),Object(s.b)("li",{parentName:"ol"},"Do not store the token anywhere else."))),Object(s.b)("li",{parentName:"ul"},Object(s.b)("p",{parentName:"li"},"PyPI"),Object(s.b)("ol",{parentName:"li"},Object(s.b)("li",{parentName:"ol"},"Log in to PyPI as project-nimbus-publishing."),Object(s.b)("li",{parentName:"ol"},"Go to the account settings in the left-side menu."),Object(s.b)("li",{parentName:"ol"},'In the section labeled "API Tokens", remove the old token using the "Options" drop down.'),Object(s.b)("li",{parentName:"ol"},"Add a new API token that has access to only the specific nimbus-shared package."),Object(s.b)("li",{parentName:"ol"},"Immediately copy that token to CircleCI as ",Object(s.b)("inlineCode",{parentName:"li"},"PYPI_TOKEN")," (see below)."),Object(s.b)("li",{parentName:"ol"},"Do not store the token anywhere else."))),Object(s.b)("li",{parentName:"ul"},Object(s.b)("p",{parentName:"li"},"Adding Tokens to CircleCI"),Object(s.b)("ol",{parentName:"li"},Object(s.b)("li",{parentName:"ol"},"Open ",Object(s.b)("a",Object(a.a)({parentName:"li"},{href:"https://app.circleci.com/pipelines/github/mozilla/nimbus-shared"}),"the CircleCI project"),". You can log in as any account with write access to the project."),Object(s.b)("li",{parentName:"ol"},"Open the project settings with the link in the top right."),Object(s.b)("li",{parentName:"ol"},"Open the Environment Variables section of the settings."),Object(s.b)("li",{parentName:"ol"},"Remove the variable old token."),Object(s.b)("li",{parentName:"ol"},"Add a new variable with the new token. The name should be either ",Object(s.b)("inlineCode",{parentName:"li"},"NPM_TOKEN")," or ",Object(s.b)("inlineCode",{parentName:"li"},"PYPI_TOKEN"),",\ndepending on which service the token is for.")))))}p.isMDXComponent=!0}},[["dR22",0,1]]]);